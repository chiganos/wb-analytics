<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>햃햫햟햩햦혝햦햨햟 WB</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    h1 { color: #5b21b6; }
    select, button { padding: 8px; font-size: 16px; margin-top: 10px; }
    #results { margin-top: 30px; }
    .block { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; border-radius: 6px; }
  </style>
</head>
<body>

<h1>游늵 AI WB</h1>

<label for="article-select">뉌햠햣햦혝햣 햟혝햦햨혞햩:</label><br/>
<select id="article-select">
  {% for art in articles %}
  <option value="{{ art }}">{{ art }}</option>
  {% endfor %}
</select>
<input id="article-input" placeholder="햦햩햦 쒫쒫왏얧쟴햣 햟혝햦햨혞햩 쒬혞혢햫혞혩" style="margin-left:10px;" type="text"/>
<button onclick="loadAnalytics()">쮏쥃썛햟혝혧 햟햫햟햩햦혝햦햨혞</button>

<div id="results">
  <div class="block" id="sma-block">游댃 행햟햡혞향햨햟 혜햨쮏혧향혪혤햣햡 혜햣햢햫햣햡...</div>
  <div class="block" id="ads-baskets-block">游댃 행햟햡혞향햨햟 쒫햦혪햫햦혪 햣햨햩햟햪혦 햫햟 햨쮐향햦햫혞...</div>
  <div class="block" id="ads-orders-block">游댃 행햟햡혞향햨햟 쒫햦혪햫햦혪 햣햨햩햟햪혦 햫햟 향햟햨햟향혦...</div>
  <div class="block" id="price-orders-block">游댃 행햟햡혞향햨햟 쒫햦혪햫햦혪 혡햣햫혦 햫햟 향햟햨햟향혦...</div>
  <div class="block" id="price-optimization-block">游댃 행햟햡혞향햨햟 쮏혝햦햪햦향햟혡햦햦 혡햣햫혦...</div>
  <div class="block" id="price-metric-block">游댃 행햟햡혞향햨햟 햪햣혝햦햨햦...</div>
  <div class="block" id="conversion-block">游댃 행햟햡혞향햨햟 햨쮏쫧쒫왐혜햦햦 햨쮐향햦햫혦...</div>
  <div class="block" id="keywords-block">游댃 행햟햡혞향햨햟 햟햫햟햩햦향햟 햨햩혩혢햣쒬혠 혜햩쮏...</div>
  <div class="block" id="ads-shows-baskets-block">游댃 행햟햡혞향햨햟 쒫햦혪햫햦혪 쮏쥃썛쮏 햫햟 햨쮐향햦햫혦...</div>
  <div class="block" id="cpm-shows-block">游댃 행햟햡혞향햨햟 쒫햦혪햫햦혪 CPM 햫햟 쮏쥃썛혦...</div>
  <div class="block" id="gpt-block">游댃 행햟햡혞향햨햟 GPT-햟햫햟햩햦향햟...</div>
</div>

<script>
function loadAnalytics() {
  const manualInput = document.getElementById("article-input").value.trim();
  const art = manualInput !== "" ? manualInput : document.getElementById("article-select").value;

  const blocks = {
    "sma-block": "/api/analytics/sma/",
    "ads-baskets-block": "/api/analytics/ads-baskets/",
    "ads-orders-block": "/api/analytics/ads-orders/",
    "price-orders-block": "/api/analytics/price-orders/",
    "price-optimization-block": "/api/analytics/price-optimization/",
    "price-metric-block": "/api/analytics/price-metric/",
    "conversion-block": "/api/analytics/price-conversion/",
    "keywords-block": "/api/analytics/keywords/",
    "ads-shows-baskets-block": "/api/analytics/ads-shows-baskets/",
    "cpm-shows-block": "/api/analytics/cpm-shows/",
    "gpt-block": "/api/analytics/gpt/"
  };

  for (const [blockId, endpoint] of Object.entries(blocks)) {
    const el = document.getElementById(blockId);
    if (!el) continue;

    el.innerText = "游댃 행햟햡혞향햨햟...";
    fetch(endpoint + art)
      .then(resp => resp.text())
      .then(data => {
        el.innerHTML = data;

        // 뉌쮏햫혪햣햪 혜햨햦혝혦 쮐햩햣 쒬혝햟쒫쥃
        el.querySelectorAll("script").forEach(oldScript => {
          const newScript = document.createElement("script");
          if (oldScript.src) {
            newScript.src = oldScript.src;
          } else {
            newScript.textContent = oldScript.textContent;
          }
          oldScript.parentNode.replaceChild(newScript, oldScript);
        });
      })
      .catch(err => {
        el.innerText = "丘멆잺 뤰걣쟳쐃쥃 향햟햡혞향햨햦";
        console.error(err);
      });
  }
}
</script>

</body>
</html>